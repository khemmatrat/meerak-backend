# ğŸ¯ Phase 2: KYC Wizard - Step-by-Step Verification

## âœ¨ **Features Overview**

### **Multi-Step KYC Process:**
```
Step 1: Personal Info (à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¹ˆà¸§à¸™à¸•à¸±à¸§)
  â”œâ”€â”€ à¸Šà¸·à¹ˆà¸­-à¸™à¸²à¸¡à¸ªà¸à¸¸à¸¥
  â”œâ”€â”€ à¹€à¸¥à¸‚à¸šà¸±à¸•à¸£à¸›à¸£à¸°à¸Šà¸²à¸Šà¸™ (13 à¸«à¸¥à¸±à¸ + validation)
  â”œâ”€â”€ à¸§à¸±à¸™à¹€à¸à¸´à¸”
  â””â”€â”€ à¸—à¸µà¹ˆà¸­à¸¢à¸¹à¹ˆ

Step 2: ID Card Upload (à¸­à¸±à¸›à¹‚à¸«à¸¥à¸”à¸šà¸±à¸•à¸£à¸›à¸£à¸°à¸Šà¸²à¸Šà¸™)
  â”œâ”€â”€ à¸£à¸¹à¸›à¸šà¸±à¸•à¸£à¸”à¹‰à¸²à¸™à¸«à¸™à¹‰à¸²
  â””â”€â”€ à¸£à¸¹à¸›à¸šà¸±à¸•à¸£à¸”à¹‰à¸²à¸™à¸«à¸¥à¸±à¸‡

Step 3: Selfie (à¸–à¹ˆà¸²à¸¢à¸£à¸¹à¸›à¹ƒà¸šà¸«à¸™à¹‰à¸²)
  â””â”€â”€ à¸£à¸¹à¸›à¸–à¹ˆà¸²à¸¢à¹ƒà¸šà¸«à¸™à¹‰à¸²à¸•à¸£à¸‡

Step 4: Driver License (à¹ƒà¸šà¸‚à¸±à¸šà¸‚à¸µà¹ˆ - à¸–à¹‰à¸²à¸¡à¸µ) â­ NEW!
  â”œâ”€â”€ à¹€à¸¥à¸‚à¹ƒà¸šà¸‚à¸±à¸šà¸‚à¸µà¹ˆ
  â”œâ”€â”€ à¸›à¸£à¸°à¹€à¸ à¸— (à¸Šà¸±à¹ˆà¸§à¸„à¸£à¸²à¸§/à¸–à¸²à¸§à¸£/à¸ªà¸²à¸à¸¥)
  â”œâ”€â”€ à¸Šà¸±à¹‰à¸™à¹ƒà¸šà¸‚à¸±à¸šà¸‚à¸µà¹ˆ
  â”œâ”€â”€ à¸§à¸±à¸™à¸«à¸¡à¸”à¸­à¸²à¸¢à¸¸
  â””â”€â”€ à¸£à¸¹à¸›à¹ƒà¸šà¸‚à¸±à¸šà¸‚à¸µà¹ˆ

Step 5: Vehicle Registration (à¸—à¸°à¹€à¸šà¸µà¸¢à¸™à¸£à¸– - à¸–à¹‰à¸²à¸¡à¸µ) â­ NEW!
  â”œâ”€â”€ à¸—à¸°à¹€à¸šà¸µà¸¢à¸™à¸£à¸–
  â”œâ”€â”€ à¸›à¸£à¸°à¹€à¸ à¸—à¸£à¸– (à¸£à¸–à¸¢à¸™à¸•à¹Œ/à¸¡à¸­à¹€à¸•à¸­à¸£à¹Œà¹„à¸‹à¸„à¹Œ/à¸à¸£à¸°à¸šà¸°)
  â”œâ”€â”€ à¸¢à¸µà¹ˆà¸«à¹‰à¸­/à¸£à¸¸à¹ˆà¸™
  â”œâ”€â”€ à¸›à¸µà¸ˆà¸”à¸—à¸°à¹€à¸šà¸µà¸¢à¸™
  â”œâ”€â”€ à¸ªà¸µ
  â”œâ”€â”€ à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”
  â”œâ”€â”€ à¸£à¸¹à¸›à¹€à¸¥à¹ˆà¸¡à¸—à¸°à¹€à¸šà¸µà¸¢à¸™à¸£à¸–
  â”œâ”€â”€ à¸§à¸±à¸™à¸«à¸¡à¸”à¸­à¸²à¸¢à¸¸ à¸.à¸£.à¸š.
  â”œâ”€â”€ à¸Šà¸·à¹ˆà¸­à¹€à¸ˆà¹‰à¸²à¸‚à¸­à¸‡à¸£à¸–
  â””â”€â”€ à¸„à¸§à¸²à¸¡à¸ªà¸±à¸¡à¸à¸±à¸™à¸˜à¹Œà¸à¸±à¸šà¹€à¸ˆà¹‰à¸²à¸‚à¸­à¸‡ (à¸–à¹‰à¸²à¹„à¸¡à¹ˆà¹ƒà¸Šà¹ˆà¹€à¸ˆà¹‰à¸²à¸‚à¸­à¸‡)

Step 6: Review & Submit (à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¹à¸¥à¸°à¸ªà¹ˆà¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥)
  â””â”€â”€ à¸ªà¸£à¸¸à¸›à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”à¸à¹ˆà¸­à¸™à¸ªà¹ˆà¸‡
```

---

## ğŸ›¡ï¸ **Security Features**

### **1. Field-Level Encryption**
```typescript
// à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸µà¹ˆà¹€à¸‚à¹‰à¸²à¸£à¸«à¸±à¸ª:
- à¹€à¸¥à¸‚à¸šà¸±à¸•à¸£à¸›à¸£à¸°à¸Šà¸²à¸Šà¸™ (national_id_encrypted)
- à¸Šà¸·à¹ˆà¸­-à¸™à¸²à¸¡à¸ªà¸à¸¸à¸¥ (first_name_encrypted, last_name_encrypted)
- à¸§à¸±à¸™à¹€à¸à¸´à¸” (date_of_birth_encrypted)
- à¸—à¸µà¹ˆà¸­à¸¢à¸¹à¹ˆ (address_encrypted)
- à¹€à¸¥à¸‚à¹ƒà¸šà¸‚à¸±à¸šà¸‚à¸µà¹ˆ (license_number_encrypted)
- à¸—à¸°à¹€à¸šà¸µà¸¢à¸™à¸£à¸– (license_plate_encrypted)
- à¹€à¸¥à¸‚à¸•à¸±à¸§à¸–à¸±à¸‡à¸£à¸– (chassis_number_encrypted)
- à¸Šà¸·à¹ˆà¸­à¹€à¸ˆà¹‰à¸²à¸‚à¸­à¸‡à¸£à¸– (owner_name_encrypted)
```

### **2. Thai National ID Validation**
```typescript
// Algorithm: Check digit validation
validateThaiID("1234567890123") â†’ true/false

// Format: 13 digits with checksum
// Example: 1-2345-67890-12-3
```

### **3. Data Masking**
```typescript
// UI Display (masked):
National ID: 1-xxxx-xxxxx-xx-3
Phone: 08xxx5678
License Plate: à¸à¸ xxxx à¸à¸£à¸¸à¸‡à¹€à¸—à¸à¸¡à¸«à¸²à¸™à¸„à¸£
```

---

## ğŸš— **Why Vehicle Registration?**

### **Fraud Prevention:**

1. **Anti-Impersonation (à¸›à¹‰à¸­à¸‡à¸à¸±à¸™à¸à¸²à¸£à¸ªà¸§à¸¡à¸ªà¸´à¸—à¸˜à¸´à¹Œ)**
   - à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸§à¹ˆà¸²à¸œà¸¹à¹‰à¸‚à¸±à¸šà¹€à¸›à¹‡à¸™à¹€à¸ˆà¹‰à¸²à¸‚à¸­à¸‡à¸£à¸–à¸«à¸£à¸·à¸­à¸¡à¸µà¸ªà¸´à¸—à¸˜à¸´à¹Œà¸‚à¸±à¸šà¸£à¸–
   - à¸›à¹‰à¸­à¸‡à¸à¸±à¸™à¸à¸²à¸£à¸¢à¸·à¸¡à¸£à¸–à¸œà¸¹à¹‰à¸­à¸·à¹ˆà¸™à¸¡à¸²à¹ƒà¸Šà¹‰à¹ƒà¸™à¸—à¸²à¸‡à¸—à¸µà¹ˆà¸œà¸´à¸”

2. **Legal Compliance (à¸–à¸¹à¸à¸à¸à¸«à¸¡à¸²à¸¢)**
   - à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸§à¹ˆà¸²à¸£à¸–à¸¡à¸µà¹€à¸­à¸à¸ªà¸²à¸£à¸„à¸£à¸šà¸–à¹‰à¸§à¸™
   - à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸§à¸±à¸™à¸«à¸¡à¸”à¸­à¸²à¸¢à¸¸ à¸.à¸£.à¸š.
   - à¸›à¹‰à¸­à¸‡à¸à¸±à¸™à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸£à¸–à¸œà¸´à¸”à¸à¸à¸«à¸¡à¸²à¸¢

3. **Accountability (à¸£à¸±à¸šà¸œà¸´à¸”à¸Šà¸­à¸š)**
   - à¸£à¸°à¸šà¸¸à¸•à¸±à¸§à¸•à¸™à¸œà¸¹à¹‰à¸‚à¸±à¸šà¹„à¸”à¹‰à¸Šà¸±à¸”à¹€à¸ˆà¸™
   - à¸•à¸´à¸”à¸•à¸²à¸¡à¹„à¸”à¹‰à¹ƒà¸™à¸à¸£à¸“à¸µà¹€à¸à¸´à¸”à¹€à¸«à¸•à¸¸
   - à¸ªà¸£à¹‰à¸²à¸‡à¸„à¸§à¸²à¸¡à¸™à¹ˆà¸²à¹€à¸Šà¸·à¹ˆà¸­à¸–à¸·à¸­

4. **Insurance Protection (à¸›à¸£à¸°à¸à¸±à¸™à¸ à¸±à¸¢)**
   - à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸„à¸§à¸²à¸¡à¸„à¸¸à¹‰à¸¡à¸„à¸£à¸­à¸‡
   - à¸¥à¸”à¸„à¸§à¸²à¸¡à¹€à¸ªà¸µà¹ˆà¸¢à¸‡à¸—à¸²à¸‡à¸à¸à¸«à¸¡à¸²à¸¢

---

## ğŸ“‹ **New Data Types**

### **Driver License:**
```typescript
interface DriverLicense {
  id: string;
  license_number_encrypted: string;     // à¹€à¸¥à¸‚à¹ƒà¸šà¸‚à¸±à¸šà¸‚à¸µà¹ˆ (encrypted)
  license_number_hash: string;          // Hash for lookup
  license_type: string;                 // à¸Šà¸±à¹ˆà¸§à¸„à¸£à¸²à¸§/à¸–à¸²à¸§à¸£/à¸ªà¸²à¸à¸¥
  license_class: string[];              // à¸Šà¸±à¹‰à¸™ (à¸£à¸–à¸¢à¸™à¸•à¹Œ, à¸¡à¸­à¹€à¸•à¸­à¸£à¹Œà¹„à¸‹à¸„à¹Œ)
  issue_date: string;
  expiry_date: string;
  license_photo_url: string;
  status: 'active' | 'expired' | 'suspended';
}
```

### **Vehicle Registration:**
```typescript
interface VehicleRegistration {
  id: string;
  license_plate_encrypted: string;      // à¸—à¸°à¹€à¸šà¸µà¸¢à¸™à¸£à¸– (encrypted)
  license_plate_hash: string;
  vehicle_type: 'car' | 'motorcycle' | 'truck' | 'other';
  vehicle_brand: string;                // Toyota, Honda, etc.
  vehicle_model: string;                // Camry, Civic, etc.
  vehicle_year: number;
  vehicle_color: string;
  vehicle_province: string;
  registration_book_photo_url: string;
  registration_expiry_date: string;
  owner_name_encrypted: string;         // à¸Šà¸·à¹ˆà¸­à¹€à¸ˆà¹‰à¸²à¸‚à¸­à¸‡à¸£à¸– (encrypted)
  is_owner: boolean;                    // à¹€à¸›à¹‡à¸™à¹€à¸ˆà¹‰à¸²à¸‚à¸­à¸‡à¸£à¸–à¹€à¸­à¸‡à¸«à¸£à¸·à¸­à¹„à¸¡à¹ˆ
  relationship_to_owner?: string;       // à¸„à¸§à¸²à¸¡à¸ªà¸±à¸¡à¸à¸±à¸™à¸˜à¹Œ (à¸–à¹‰à¸²à¹„à¸¡à¹ˆà¹ƒà¸Šà¹ˆà¹€à¸ˆà¹‰à¸²à¸‚à¸­à¸‡)
  status: 'active' | 'expired' | 'sold';
}
```

---

## ğŸ¨ **UI/UX Improvements**

### **Before (Profile.tsx):**
```
âŒ Single long form (scroll forever)
âŒ Overwhelming amount of fields
âŒ No progress indication
âŒ Hard to navigate back
âŒ No validation feedback
```

### **After (KYCWizard.tsx):**
```
âœ… Step-by-step process (6 steps)
âœ… Progress indicator (visual steps)
âœ… One focus area per step
âœ… Easy back/next navigation
âœ… Real-time validation
âœ… Clear instructions per step
âœ… Preview before submit
```

---

## ğŸš€ **How to Use**

### **1. Import Component:**
```typescript
import { KYCWizard } from './pages/KYCWizard';
```

### **2. Add Route:**
```typescript
// In App.tsx or router config
<Route path="/kyc" element={<KYCWizard />} />
```

### **3. Navigate from Profile:**
```typescript
<button onClick={() => navigate('/kyc')}>
  à¸¢à¸·à¸™à¸¢à¸±à¸™à¸•à¸±à¸§à¸•à¸™ (KYC)
</button>
```

---

## ğŸ“¸ **Screenshot Flow**

### **Step 1: Personal Info**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¹ˆà¸§à¸™à¸•à¸±à¸§                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [à¸Šà¸·à¹ˆà¸­à¸ˆà¸£à¸´à¸‡]  [à¸™à¸²à¸¡à¸ªà¸à¸¸à¸¥]         â”‚
â”‚  [à¹€à¸¥à¸‚à¸šà¸±à¸•à¸£à¸›à¸£à¸°à¸Šà¸²à¸Šà¸™ 13 à¸«à¸¥à¸±à¸]     â”‚
â”‚  [à¸§à¸±à¸™à¹€à¸à¸´à¸”]                     â”‚
â”‚  [à¸—à¸µà¹ˆà¸­à¸¢à¸¹à¹ˆ]                      â”‚
â”‚                                 â”‚
â”‚  â„¹ï¸ à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸°à¸–à¸¹à¸à¹€à¸‚à¹‰à¸²à¸£à¸«à¸±à¸ªà¸à¹ˆà¸­à¸™à¸šà¸±à¸™à¸—à¸¶à¸ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **Step 2: ID Card**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  à¸­à¸±à¸›à¹‚à¸«à¸¥à¸”à¸šà¸±à¸•à¸£à¸›à¸£à¸°à¸Šà¸²à¸Šà¸™            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [à¸”à¹‰à¸²à¸™à¸«à¸™à¹‰à¸²]  [à¸”à¹‰à¸²à¸™à¸«à¸¥à¸±à¸‡]        â”‚
â”‚   ğŸ“· Upload    ğŸ“· Upload         â”‚
â”‚                                 â”‚
â”‚  ğŸ’¡ à¸„à¸³à¹à¸™à¸°à¸™à¸³:                    â”‚
â”‚  - à¸–à¹ˆà¸²à¸¢à¹ƒà¸™à¸—à¸µà¹ˆà¸¡à¸µà¹à¸ªà¸‡à¸ªà¸§à¹ˆà¸²à¸‡           â”‚
â”‚  - à¸šà¸±à¸•à¸£à¸•à¹‰à¸­à¸‡à¸Šà¸±à¸”à¹€à¸ˆà¸™ à¸­à¹ˆà¸²à¸™à¹„à¸”à¹‰       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **Step 4: Driver License (NEW!)**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  à¹ƒà¸šà¸‚à¸±à¸šà¸‚à¸µà¹ˆ (à¸–à¹‰à¸²à¸¡à¸µ)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â˜‘ à¸‰à¸±à¸™à¸¡à¸µà¹ƒà¸šà¸‚à¸±à¸šà¸‚à¸µà¹ˆ               â”‚
â”‚                                 â”‚
â”‚  [à¹€à¸¥à¸‚à¹ƒà¸šà¸‚à¸±à¸šà¸‚à¸µà¹ˆ]                 â”‚
â”‚  [à¸›à¸£à¸°à¹€à¸ à¸—: à¸–à¸²à¸§à¸£ â–¼]              â”‚
â”‚  [à¸§à¸±à¸™à¸«à¸¡à¸”à¸­à¸²à¸¢à¸¸]                  â”‚
â”‚  [à¸£à¸¹à¸›à¹ƒà¸šà¸‚à¸±à¸šà¸‚à¸µà¹ˆ]                  â”‚
â”‚   ğŸ“· Upload                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **Step 5: Vehicle (NEW!)**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  à¸—à¸°à¹€à¸šà¸µà¸¢à¸™à¸£à¸– (à¸–à¹‰à¸²à¸¡à¸µ)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â˜‘ à¸‰à¸±à¸™à¸¡à¸µà¸£à¸–à¸¢à¸™à¸•à¹Œ/à¸¡à¸­à¹€à¸•à¸­à¸£à¹Œà¹„à¸‹à¸„à¹Œ     â”‚
â”‚                                 â”‚
â”‚  â”Œâ”€ à¸£à¸–à¸„à¸±à¸™à¸—à¸µà¹ˆ 1 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ [à¸—à¸°à¹€à¸šà¸µà¸¢à¸™: à¸à¸ 1234 à¸à¸—à¸¡]  â”‚  â”‚
â”‚  â”‚ [à¸›à¸£à¸°à¹€à¸ à¸—: à¸£à¸–à¸¢à¸™à¸•à¹Œ â–¼]      â”‚  â”‚
â”‚  â”‚ [à¸¢à¸µà¹ˆà¸«à¹‰à¸­: Toyota]         â”‚  â”‚
â”‚  â”‚ [à¸£à¸¸à¹ˆà¸™: Camry]            â”‚  â”‚
â”‚  â”‚ â˜‘ à¸‰à¸±à¸™à¹€à¸›à¹‡à¸™à¹€à¸ˆà¹‰à¸²à¸‚à¸­à¸‡à¸£à¸–à¸„à¸±à¸™à¸™à¸µà¹‰ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                 â”‚
â”‚  [+ à¹€à¸à¸´à¹ˆà¸¡à¸£à¸–à¸­à¸µà¸à¸„à¸±à¸™]             â”‚
â”‚                                 â”‚
â”‚  ğŸ›¡ï¸ à¸›à¹‰à¸­à¸‡à¸à¸±à¸™à¸à¸²à¸£à¸ªà¸§à¸¡à¸ªà¸´à¸—à¸˜à¸´à¹Œà¹à¸¥à¸°    â”‚
â”‚     à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸£à¸–à¸œà¸´à¸”à¸à¸à¸«à¸¡à¸²à¸¢          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âœ… **Validation Rules**

### **Step 1: Personal Info**
- âœ… First name: Required
- âœ… Last name: Required
- âœ… National ID: Required, 13 digits, valid checksum
- âœ… Date of birth: Required, < today
- âœ… Address: Required

### **Step 2: ID Card**
- âœ… Front photo: Required
- âœ… Back photo: Required
- âœ… Image format: JPG, PNG
- âœ… Max size: 5MB

### **Step 3: Selfie**
- âœ… Photo: Required
- âœ… Clear face visible

### **Step 4: Driver License (Optional)**
- If has license:
  - âœ… License number: Required
  - âœ… Expiry date: Required, > today
  - âœ… License photo: Required

### **Step 5: Vehicle (Optional)**
- If has vehicle:
  - âœ… At least 1 vehicle
  - âœ… License plate: Required
  - âœ… Brand/Model: Required
  - âœ… Registration book photo: Required
  - âœ… Owner info: Required if not owner

---

## ğŸ§ª **Testing Guide**

### **Test Case 1: Complete KYC with All Options**
```
1. Go to /kyc
2. Fill personal info (valid Thai ID)
3. Upload ID card (front + back)
4. Upload selfie
5. âœ… Check "à¸‰à¸±à¸™à¸¡à¸µà¹ƒà¸šà¸‚à¸±à¸šà¸‚à¸µà¹ˆ"
   - Fill license number
   - Upload license photo
6. âœ… Check "à¸‰à¸±à¸™à¸¡à¸µà¸£à¸–à¸¢à¸™à¸•à¹Œ/à¸¡à¸­à¹€à¸•à¸­à¸£à¹Œà¹„à¸‹à¸„à¹Œ"
   - Add vehicle info
   - Upload registration book
7. Review all data
8. Submit
9. âœ… Check Firestore: kyc_records collection
```

### **Test Case 2: Minimal KYC (No License/Vehicle)**
```
1-4. Same as above
5. âŒ Skip driver license
6. âŒ Skip vehicle
7-9. Review and submit
```

### **Test Case 3: Multiple Vehicles**
```
1-4. Same as Test 1
5. Skip license
6. âœ… Check vehicle
   - Add 1st vehicle
   - Click "+ à¹€à¸à¸´à¹ˆà¸¡à¸£à¸–à¸­à¸µà¸à¸„à¸±à¸™"
   - Add 2nd vehicle
7-9. Review and submit
```

---

## ğŸ“Š **Firestore Data Structure**

### **After Submission:**
```javascript
// Collection: kyc_records
{
  id: "kyc_1769602180000_abc123",
  user_id: "user_1769600571617_98xg5d",
  
  // Personal Info (ENCRYPTED)
  national_id_encrypted: "eyJhbGciOiJBMjU2R0NNIiwi...",
  national_id_hash: "abc123def456...",
  first_name_encrypted: "eyJhbGci...",
  last_name_encrypted: "eyJhbGci...",
  date_of_birth_encrypted: "eyJhbGci...",
  address_encrypted: "eyJhbGci...",
  
  // Documents
  documents: [
    {
      type: "thai_id_card",
      url: "https://res.cloudinary.com/..."
    },
    {
      type: "selfie",
      url: "https://res.cloudinary.com/..."
    }
  ],
  
  // Driver License (Optional)
  driver_license: {
    license_number_encrypted: "eyJhbGci...",
    license_number_hash: "xyz789...",
    license_type: "à¸–à¸²à¸§à¸£",
    expiry_date: "2028-12-31",
    license_photo_url: "https://res.cloudinary.com/...",
    status: "active"
  },
  
  // Vehicles (Optional - Array)
  vehicles: [
    {
      id: "vehicle_001",
      license_plate_encrypted: "eyJhbGci...",
      license_plate_hash: "plate123...",
      vehicle_type: "car",
      vehicle_brand: "Toyota",
      vehicle_model: "Camry",
      vehicle_year: 2023,
      vehicle_color: "Silver",
      vehicle_province: "à¸à¸£à¸¸à¸‡à¹€à¸—à¸à¸¡à¸«à¸²à¸™à¸„à¸£",
      registration_book_photo_url: "https://res.cloudinary.com/...",
      registration_expiry_date: "2027-06-30",
      owner_name_encrypted: "eyJhbGci...",
      is_owner: true,
      status: "active"
    }
  ],
  
  // Status
  kyc_level: 1,  // LITE
  kyc_status: "pending",
  submitted_at: "2026-01-28T12:30:00Z",
  
  // Audit
  created_at: "2026-01-28T12:30:00Z",
  updated_at: "2026-01-28T12:30:00Z"
}
```

---

## ğŸ¯ **Next Steps**

### **Phase 2.1 (Current):**
- [x] KYC Wizard UI
- [x] Driver License registration
- [x] Vehicle registration
- [ ] Admin review dashboard

### **Phase 2.2:**
- [ ] Face matching AI
- [ ] ID card OCR extraction
- [ ] Auto-verify if confidence > 90%

---

## ğŸ”— **Files Created/Modified**

### **New Files:**
- `pages/KYCWizard.tsx` - Main wizard component (1000+ lines)
- `PHASE_2_KYC_WIZARD.md` - This documentation

### **Modified Files:**
- `types.ts` - Added DriverLicense & VehicleRegistration interfaces
- `utils/encryption.ts` - Encryption utilities
- `utils/dataMasking.ts` - Data masking utilities
- `services/kycService.ts` - KYC service functions

---

**Last Updated:** 2026-01-28
**Status:** âœ… READY FOR TESTING
**Security Level:** ğŸ”’ğŸ”’ğŸ”’ğŸ”’ğŸ”’ (5/5 - Maximum)
